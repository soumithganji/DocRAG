2025-08-04 12:23:49,928 - INFO - api - Logging initialized. Log file will be saved to: logs\api_run_2025-08-04_12-23-49.log
2025-08-04 12:23:57,552 - DEBUG - api - Verifying API key...
2025-08-04 12:23:57,552 - DEBUG - api - API key verification successful.
2025-08-04 12:23:57,553 - INFO - api - --- Received request in /api/v1/hackrx/run for 1 questions ---
2025-08-04 12:23:57,554 - DEBUG - api - Request body: {
  "documents": "https://hackrx.blob.core.windows.net/assets/Family%20Medicare%20Policy%20(UIN-%20UIIHLIP22070V042122)%201.pdf?sv=2023-01-03&st=2025-07-22T10%3A17%3A39Z&se=2025-08-23T10%3A17%3A00Z&sr=b&sp=r&sig=dA7BEMIZg3WcePcckBOb4QjfxK%2B4rIfxBs2%2F%2BNwoPjQ%3D",
  "questions": [
    "Is abortion covered?"
  ]
}
2025-08-04 12:23:57,554 - DEBUG - api - Getting retriever...
2025-08-04 12:23:57,554 - INFO - api - --- In get_retriever ---
2025-08-04 12:23:57,554 - INFO - api - Documents provided in request. Using on-the-fly FAISS retriever.
2025-08-04 12:23:57,554 - DEBUG - api - Document URLs: ['https://hackrx.blob.core.windows.net/assets/Family%20Medicare%20Policy%20(UIN-%20UIIHLIP22070V042122)%201.pdf?sv=2023-01-03&st=2025-07-22T10%3A17%3A39Z&se=2025-08-23T10%3A17%3A00Z&sr=b&sp=r&sig=dA7BEMIZg3WcePcckBOb4QjfxK%2B4rIfxBs2%2F%2BNwoPjQ%3D']
2025-08-04 12:23:57,554 - INFO - api - Cache miss. Processing new documents.
2025-08-04 12:23:57,556 - DEBUG - api - Downloading document from https://hackrx.blob.core.windows.net/assets/Family%20Medicare%20Policy%20(UIN-%20UIIHLIP22070V042122)%201.pdf?sv=2023-01-03&st=2025-07-22T10%3A17%3A39Z&se=2025-08-23T10%3A17%3A00Z&sr=b&sp=r&sig=dA7BEMIZg3WcePcckBOb4QjfxK%2B4rIfxBs2%2F%2BNwoPjQ%3D...
2025-08-04 12:23:57,558 - DEBUG - connectionpool - Starting new HTTPS connection (1): hackrx.blob.core.windows.net:443
2025-08-04 12:23:58,104 - DEBUG - connectionpool - https://hackrx.blob.core.windows.net:443 "GET /assets/Family%20Medicare%20Policy%20(UIN-%20UIIHLIP22070V042122)%201.pdf?sv=2023-01-03&st=2025-07-22T10%3A17%3A39Z&se=2025-08-23T10%3A17%3A00Z&sr=b&sp=r&sig=dA7BEMIZg3WcePcckBOb4QjfxK%2B4rIfxBs2%2F%2BNwoPjQ%3D HTTP/1.1" 200 590035
2025-08-04 12:23:58,725 - DEBUG - api - Loading PDF from temporary path: C:\Users\arpit\AppData\Local\Temp\tmpvb68pnn1\doc_0.pdf
2025-08-04 12:24:01,275 - DEBUG - api - Total pages loaded: 33
2025-08-04 12:24:01,280 - DEBUG - api - Split documents into 129 chunks.
2025-08-04 12:24:01,281 - DEBUG - api - Creating FAISS vector store from chunks...
2025-08-04 12:24:01,282 - DEBUG - connectionpool - Starting new HTTPS connection (1): integrate.api.nvidia.com:443
2025-08-04 12:24:04,193 - DEBUG - connectionpool - https://integrate.api.nvidia.com:443 "POST /v1/embeddings HTTP/1.1" 200 4067443
2025-08-04 12:24:08,669 - DEBUG - connectionpool - Starting new HTTPS connection (1): integrate.api.nvidia.com:443
2025-08-04 12:24:11,214 - DEBUG - connectionpool - https://integrate.api.nvidia.com:443 "POST /v1/embeddings HTTP/1.1" 200 4067538
2025-08-04 12:24:14,185 - DEBUG - connectionpool - Starting new HTTPS connection (1): integrate.api.nvidia.com:443
2025-08-04 12:24:16,376 - DEBUG - connectionpool - https://integrate.api.nvidia.com:443 "POST /v1/embeddings HTTP/1.1" 200 2359587
2025-08-04 12:24:17,724 - DEBUG - loader - Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU
2025-08-04 12:24:17,728 - INFO - loader - Loading faiss with AVX2 support.
2025-08-04 12:24:17,757 - INFO - loader - Successfully loaded faiss with AVX2 support.
2025-08-04 12:24:17,764 - INFO - __init__ - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes. This is only an error if you're trying to use GPU Faiss.
2025-08-04 12:24:17,785 - INFO - api - FAISS vector store created and cached.
2025-08-04 12:24:17,786 - DEBUG - api - Initializing NVIDIARerank for compression.
2025-08-04 12:24:17,787 - INFO - api - Retriever setup complete with re-ranker.
2025-08-04 12:24:17,787 - DEBUG - api - Retriever obtained.
2025-08-04 12:24:17,787 - DEBUG - api - Creating RAG chain...
2025-08-04 12:24:17,790 - INFO - api - RAG chain created successfully.
2025-08-04 12:24:17,790 - DEBUG - api - Creating 1 parallel tasks for questions.
2025-08-04 12:24:17,790 - INFO - api - Processing question: 'Is abortion covered?'
2025-08-04 12:24:17,802 - DEBUG - connectionpool - Starting new HTTPS connection (1): integrate.api.nvidia.com:443
2025-08-04 12:24:18,191 - DEBUG - connectionpool - https://integrate.api.nvidia.com:443 "POST /v1/embeddings HTTP/1.1" 200 81272
2025-08-04 12:24:18,454 - DEBUG - connectionpool - Starting new HTTPS connection (1): ai.api.nvidia.com:443
2025-08-04 12:24:18,909 - DEBUG - connectionpool - https://ai.api.nvidia.com:443 "POST /v1/retrieval/nvidia/llama-3_2-nv-rerankqa-1b-v2/reranking HTTP/1.1" 200 220
2025-08-04 12:24:18,916 - DEBUG - connectionpool - Starting new HTTPS connection (1): integrate.api.nvidia.com:443
2025-08-04 12:24:19,721 - DEBUG - connectionpool - https://integrate.api.nvidia.com:443 "POST /v1/chat/completions HTTP/1.1" 200 522
2025-08-04 12:24:19,724 - DEBUG - api - Raw result from RAG chain for 'Is abortion covered?': {'input': 'Is abortion covered?', 'context': [Document(id='7662fffd-faab-4307-90d9-47a2401969c2', metadata={'producer': 'iLovePDF', 'creator': 'PyPDF', 'creationdate': '', 'moddate': '2021-09-30T09:44:59+00:00', 'source': 'C:\\Users\\arpit\\AppData\\Local\\Temp\\tmpvb68pnn1\\doc_0.pdf', 'total_pages': 33, 'page': 11, 'page_label': '12', 'relevance_score': -5.12109375}, page_content='in-patients in India. \nii. Surrogate or vicarious pregnancy is not covered. \niii. Expenses incurred in connection with voluntary medical termination of pregnancy during the \nfirst twelve weeks from the date of conception are not covered. \niv. Pre-natal and post-natal expenses are not covered unless admitted in Hospital/Nursing Home \nand treatment is taken there. \nv. Pre Hospitalisati on and Post -Hospitalisation benefits are not available under these two \nclauses. \nvi. Subject to the terms & conditions, the Policy covers New Born Baby beyond 90 days o nly on \npayment of requisite premium. \nIf this Option is in force in respect of the Insured Person, then the relevant part of Exclusion V I.B.14 will \nbe deemed inoperative for the purpose of this Option. \n \n12. Daily Cash Allowance on Hospitalisation \nWe will pay Daily Cash Allowance to the Insured Person for every continuous and completed period of 24'), Document(id='8ae6bef8-62c3-4cc8-b43b-2fb5a2f57b08', metadata={'producer': 'iLovePDF', 'creator': 'PyPDF', 'creationdate': '', 'moddate': '2021-09-30T09:44:59+00:00', 'source': 'C:\\Users\\arpit\\AppData\\Local\\Temp\\tmpvb68pnn1\\doc_0.pdf', 'total_pages': 33, 'page': 14, 'page_label': '15', 'relevance_score': -6.2578125}, page_content='b. Expenses towards miscarriage (unless due to an ac cident) and lawful medical termination of \npregnancy during the policy period. \nC. SPECIFIC PERMANENT EXCLUSIONS \n \n15. All expenses caused by or arising from or attributable to foreign invasion, act of foreign enemies, \nhostilities, warlike operations (whether war be declared or not or while performing duties in the \narmed forces of any country), civil war, public defence, rebellion, revolution, insurrection, military or \nusurped power. \n16. All Illness/expenses caused by ionizing radiation or contamination by  radioactivity from any nuclear \nfuel (explosive or hazardous form) or from any nuclear waste from the combustion of nuclear fuel \nnuclear, chemical or biological attack. \n17. a) Stem cell implantation/Surgery/therapy, harvesting, storage or any kind of Treatment  using stem \ncells except as provided for in Clause V.9.L above; b) growth hormone therapy.   \n18. Congenital External Diseases, Defects or anomalies.'), Document(id='e8274e1c-7389-410f-9f3d-6d7d0d36b36a', metadata={'producer': 'iLovePDF', 'creator': 'PyPDF', 'creationdate': '', 'moddate': '2021-09-30T09:44:59+00:00', 'source': 'C:\\Users\\arpit\\AppData\\Local\\Temp\\tmpvb68pnn1\\doc_0.pdf', 'total_pages': 33, 'page': 14, 'page_label': '15', 'relevance_score': -10.2421875}, page_content='cells except as provided for in Clause V.9.L above; b) growth hormone therapy.   \n18. Congenital External Diseases, Defects or anomalies.  \n19. Circumcision unless necessary for Treatment of an Illness or Injury not excluded hereunder or due to \nan Accident. \n20. Cost of routine medical examination and preventive health check -up unless as provided for in Base \nCover V.8'), Document(id='124f9f14-df7e-43ea-abc2-7c8bd16e0729', metadata={'producer': 'iLovePDF', 'creator': 'PyPDF', 'creationdate': '', 'moddate': '2021-09-30T09:44:59+00:00', 'source': 'C:\\Users\\arpit\\AppData\\Local\\Temp\\tmpvb68pnn1\\doc_0.pdf', 'total_pages': 33, 'page': 14, 'page_label': '15', 'relevance_score': -11.375}, page_content='refractive error less than 7.5 dioptres. \n12. Unproven Treatments (Code- Excl16): Expenses related to any unproven treatment, services and \nsupplies for or in connection with any treatment. Unproven treatments are treatments, procedures \nor supplies that lack significant medical documentation to support their effectiveness.  \n13. Sterility and Infertility (Code- Excl17): Expenses related to sterility and infertility. This includes: \ni. Any type of contraception, sterilization \nii. Assisted Reproduction services including artificial insemination and advanced reproductive \ntechnologies such as IVF, ZIFT, GIFT, ICSI \niii. Gestational Surrogacy \niv. Reversal of sterilization \n14. Maternity (Code- Excl18): \na. Medical treatment expenses traceable to childbirth (including complicated deliveries and \ncaesarean sections incurred during hospitalisation) except ectopic pregnancy; \nb. Expenses towards miscarriage (unless due to an ac cident) and lawful medical termination of'), Document(id='86506449-8e35-4afb-ba3e-790f4b6144d9', metadata={'producer': 'iLovePDF', 'creator': 'PyPDF', 'creationdate': '', 'moddate': '2021-09-30T09:44:59+00:00', 'source': 'C:\\Users\\arpit\\AppData\\Local\\Temp\\tmpvb68pnn1\\doc_0.pdf', 'total_pages': 33, 'page': 15, 'page_label': '16', 'relevance_score': -14.7890625}, page_content='32. Treatments including Rotational Field Quantum Magnetic Resonance (RFQMR), External Counter \nPulsation (ECP), Enhanced External Counter Pulsation (EECP), Hyperbaric Oxygen Therapy , \nchondrocyte or osteocyte implantation, procedures using platelet rich plasma, Trans Cutaneous \nElectric Nerve Stimulation; Use of oral immunomodulatory/ supplemental drugs. \n33. Artificial life maintenance including life support machine use, from the date of confirmation by the \ntreating doctor that the patient is in a vegetative state \n34. Any item(s) or treatment specified in ‘list of expenses (non-medical) – payable/ non-payable’ as per \nAnnexure-1 and available on Company web site also, unless specifically covered under the Policy.  \n \nVII. TERMS AND CLAUSES \nA. STANDARD GENERAL TERMS AND CLAUSES \n \n1. Condition Precedent to Admission of Liability: The terms and conditions of the policy must be fulfilled')], 'answer': 'No, expenses incurred in connection with voluntary medical termination of pregnancy during the first twelve weeks from the date of conception are not covered under the insurance policy.'}
2025-08-04 12:24:19,725 - INFO - api - Final answer for 'Is abortion covered?' generated in 1.93s
2025-08-04 12:24:19,776 - DEBUG - api - Raw answers from asyncio.gather: ['No, expenses incurred in connection with voluntary medical termination of pregnancy during the first twelve weeks from the date of conception are not covered under the insurance policy.']
2025-08-04 12:24:19,776 - DEBUG - api - Processed answers: ['No, expenses incurred in connection with voluntary medical termination of pregnancy during the first twelve weeks from the date of conception are not covered under the insurance policy.']
2025-08-04 12:24:19,776 - INFO - api - Returning final response.
